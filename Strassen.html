
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Explicación del algoritmo · GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.2">
        
        
        
    
    <link rel="stylesheet" href="gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="Comparativa.html" />
    
    
    <link rel="prev" href="./" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        <li class="header">Capítulos</li>
        
        
    
        <li class="chapter " data-level="1.1" data-path="./">
            
                <a href="./">
            
                    
                    Introducción
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.2" data-path="Strassen.html">
            
                <a href="Strassen.html">
            
                    
                    Explicación del algoritmo
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="Comparativa.html">
            
                <a href="Comparativa.html">
            
                    
                    Comparativa gráfica
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="Conclusiones.html">
            
                <a href="Conclusiones.html">
            
                    
                    Conclusiones
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="Referencias.html">
            
                <a href="Referencias.html">
            
                    
                    Bibliografía
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="." >Explicación del algoritmo</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h2 id="explicaci&#xF3;n-del-algoritmo">EXPLICACI&#xD3;N DEL ALGORITMO</h2>
<h3 id="diferencias-con-el-algoritmo-recursivo-b&#xE1;sico">Diferencias con el algoritmo recursivo b&#xE1;sico</h3>
<p>El algoritmo de Strassen mejora tan s&#xF3;lo levemente la complejidad del primer algoritmo recursivo para multiplicaci&#xF3;n de matrices. La combinaci&#xF3;n de las sub-soluciones las lleva a cabo de exactamente igual forma, y ya veremos que en esencia lleva a cabo exactamente el mismo procedimiento a la hora de hallar las soluciones de cada uno de los subproblemas en cada nivel de recursividad. La clave reside en que Strassen se las arregl&#xF3; para tener que llevar a cabo tan solo siete productos de matrices para resolver cada subproblema, mientras que el primer algoritmo recursivo deb&#xED;a realizar ocho productos.</p>
<p>Veamos primero el procedimiento de multiplicaci&#xF3;n:</p>
<p><img src="images/EsquemaStrassen.jpg" alt="Esquema del algoritmo de Strassen"></p>
<p>Como vemos, entran en juego unas matrices <script type="math/tex; "> P_{1-7} </script> que no hab&#xED;amos visto hasta ahora. En principio, la definici&#xF3;n de estas matrices implica cada una un producto de submatrices desde la A hasta la H.</p>
<pre><code>P1 = A * (F - H)
P2 = (A + B) * H
P3 = (C + D) * E
P4 = D * (G - E)
P5 = (A + D) * (E + H)
P6 = (B - D) * (G + H)
P7 = (A - C) * (E + F)
</code></pre><p>Aqu&#xED; tenemos los siete productos que realiza el algoritmo de Strassen para resolver cada subproblema. La pregunta ahora est&#xE1; en su procedencia. Lo cierto es que esta no es para nada trivial, pero efectivamente, si llevamos a cabo las sustituciones pertinentes, veremos c&#xF3;mo la secuencia de sumas y restas que se llevan a cabo con las submatrices <script type="math/tex; "> P_{1-7} </script> equivale a las distintas sumas de productos que utilizaba el primer algoritmo recursivo. Veamos un ejemplo:</p>
<p><script type="math/tex; "> P_5 + P_4 - P_2 + P_6 = (A + D) * (E + H) + D * (G - E) - H * (A + B) + (B - D) * (G + H) = </script></p>
<p><script type="math/tex; "> AE + AH + DE + DH + DG - DE - HA - HB + BG - BH - DG - DH = AE + BG </script></p>
<p>Como podemos ver, el producto de sumas que el primer algoritmo recursivo coloca en el cuadrante superior izquierdo de la matriz resultado, tiene exactamente el mismo valor que la operaci&#xF3;n con las matrices <script type="math/tex; "> P_i </script>. Y si llevamos a cabo la comprobaci&#xF3;n para los otros tres cuadrantes, ver&#xED;amos que tambi&#xE9;n son equivalentes. </p>
<hr>
<h3 id="pseudoc&#xF3;digo">Pseudoc&#xF3;digo</h3>
<pre><code>Strassen (MA, MB)

    ad_hoc
        // Dividimos las matrices MA y MB en cuatro componentes cada una
        // Genera los n&#xFA;meros A(MA11), B(MA12), C(MA21), D(MA22), E(MB11), F(MB12), G(MB21) y H(MB22)
        P1 = A * (F - H)
        P2 = (A + B) * H
        P3 = (C + D) * E
        P4 = D * (G - E)
        P5 = (A + D) * (E + H)
        P6 = (B - D) * (G + H)
        P7 = (A - C) * (E + F)

        // Creamos los cuatro elementos de la soluci&#xF3;n
        R11 = P5 + P4 - P2 + P6
        R12 = P1 + P2
        R21 = P3 + P4
        R22 = P1 + P5 - P3 - P7

        R = fusion(R11, R12, R21, R22);
        return R;

    else
        // Dividimos las matrices MA y MB en cuatro cuadrantes cada una
        // Se generan las submatrices A, B, C, D, E, F, G y H

        P1 = Strassen(A, (F - H));
        P2 = Strassen((A + B), H);
        P3 = Strassen((C + D), E);
        P4 = Strassen(D, (G - E));
        P5 = Strassen((A + D), (E + H));
        P6 = Strassen((B - D), (G + H));
        P7 = Strassen((A - C), (E + F));

        // Creamos los cuatro elementos de la soluci&#xF3;n
        R11 = P5 + P4 - P2 + P6
        R12 = P1 + P2
        R21 = P3 + P4
        R22 = P1 + P5 - P3 - P7

        R = fusion(R11, R12, R21, R22);
        return R;
</code></pre><hr>
<h3 id="recurrencia">Recurrencia</h3>
<p>A continuaci&#xF3;n, vamos a analizar el algoritmo de Strassen para averiguar exactamente en qu&#xE9; medida mejora al algoritmo tradicional y al primer algoritmo recursivo. Comenzando con la recurrencia, sabemos que, para cada problema, debemos llevar a cabo siete productos. Es decir, que de cada problema, van a surgir siempre ocho subproblemas. El tiempo necesario para &quot;generar&quot; estos subproblemas, es decir, para dividir las matrices, lo consideraremos constante (&#x398;(1)). </p>
<p>Nos queda saber el tiempo necesario para fusionar las soluciones parciales (submatrices) para generar una soluci&#xF3;n mayor. Si consultamos el pseudoc&#xF3;digo, veremos c&#xF3;mo el procedimiento fusionar es fundamental en este algoritmo, como ya lo era en el primer algoritmo recursivo. Puesto que el procedimiento aqu&#xED; es exactamente el mismo que entonces, su complejidad sigue siendo proporcional al n&#xFA;mero de entradas de la matriz, es decir, (&#x398;(<script type="math/tex; "> n^2 </script>)).</p>
<p>Sabiendo todo esto, y que los casos base tratan simplemente de multiplicar, sumar y restar n&#xFA;meros, y no matrices, podemos formar la f&#xF3;rmula de recurrencia del algoritmo de Strassen:</p>
<ul>
<li>N&#xFA;mero de subproblemas por cada problema: <strong>a = 7</strong>.</li>
<li>Tama&#xF1;o de cada subproblema: <strong>b = n/2</strong>.</li>
<li>Tiempo invertido en dividir las matrices: <strong>D(n) = &#x398;(1)</strong>. Esto es despreciable frente a C(n).</li>
<li>Tiempo invertido en fusionar las submatrices: <strong>C(n) = &#x398;(<script type="math/tex; "> n^2 </script>)</strong>.</li>
</ul>
<pre><code>T(n) = &#x398;(1)                         si n = 1
T(n) = 7T(n/2) + &#x398;(n^2)            en el resto
</code></pre><p>Por el m&#xE9;todo maestro, podr&#xED;amos concluir de inmediato que la complejidad de este algoritmo es subc&#xFA;bica. El valor de a (7) es mayor que el valor de <script type="math/tex; "> b^d (2^2 = 4) </script>, y por tanto estamos ante el tercer caso que contempla el m&#xE9;todo maestro. La complejidad de este algoritmo es &#x398;(<script type="math/tex; "> n^{log_27} </script>). Puesto que el valor del <script type="math/tex; "> log_27 </script> est&#xE1; entre 2.80 y 2.81, concluimos que la complejidad es &#x398;(<script type="math/tex; "> n^{2.81} </script>).</p>
<hr>
<h3 id="an&#xE1;lisis-mediante-el-&#xE1;rbol-de-recursividad">An&#xE1;lisis mediante el &#xE1;rbol de recursividad</h3>
<p>La demostraci&#xF3;n del m&#xE9;todo maestro es bastante compleja y dar&#xED;a para un documento aparte. Adem&#xE1;s, se trata de una regla muy general. Lo que vamos a hacer es deducir la complejidad que concluimos mediante el m&#xE9;todo maestro, utilizando la t&#xE9;cnica del &#xE1;rbol de recursividad, muy com&#xFA;n a la hora de determinar la complejidad de algoritmos Divide y Vencer&#xE1;s.</p>
<p>El &#xE1;rbol de recursividad ser&#xED;a el siguiente:</p>
<p><img src="images/ArbolRecursividadStrassen.jpg" alt="&#xC1;rbol de recursividad - Algoritmo de Strassen"></p>
<p>El &#xE1;rbol al completo ser&#xED;a demasiado grande incluso para solo cuatro niveles, as&#xED; que lo hemos dibujado parcialmente. Como vemos, efectivamente de cada subproblema surgen siete nuevos subproblemas, y as&#xED; sucesivamente hasta llegar al caso base. Vemos el nivel 0, nivel 1, nivel 2, nivel 3...</p>
<ul>
<li>El n&#xFA;mero de subproblemas en cada nivel es de <script type="math/tex; "> 7^i </script>, siendo i el n&#xFA;mero del nivel.</li>
<li>Si el tama&#xF1;o de cada subproblema siempre es el tama&#xF1;o del problema del que procede dividido a la mitad, entonces podemos decir que un subproblema tiene un tama&#xF1;o igual a <script type="math/tex; "> \frac{n}{2^i} </script>.</li>
<li>Entonces, el tama&#xF1;o total de cada nivel es igual a <script type="math/tex; "> 7^i * \frac{n}{2^i} </script>.</li>
</ul>
<p>Ahora necesitamos saber cu&#xE1;ntos niveles hay exactamente. Sabemos que el &#xFA;ltimo nivel, el caso base, tiene tama&#xF1;o n = 1. Por tanto, podemos despejar i de la ecuaci&#xF3;n <script type="math/tex; "> 7^i * \frac{n}{2^i} = 1 </script>, obteniendo que i es igual a <script type="math/tex; "> log_2n </script>. Puesto que el primer nivel de todos es el nivel 0, tenemos en total <script type="math/tex; "> log_2n + 1 </script> niveles. </p>
<p>Conociendo el tama&#xF1;o de cada nivel y sabiendo el n&#xFA;mero de niveles que hay, podemos realizar la siguiente progresi&#xF3;n geom&#xE9;trica para obtener finalmente el tama&#xF1;o total del problema:</p>
<p><script type="math/tex; "> \sum_{i=0}^{log_2n} (\frac{7^i}{2^i})n = \sum_{i=0}^{log_2n-1} (\frac{7^i}{2^i})n + n^{log_27} </script></p>
<p><script type="math/tex; "> n\sum_{i=0}^{log_2n} (\frac{7^i}{2^i}) + n^{log_27} = n * k + n^{log_27} </script></p>
<p><script type="math/tex; "> T(n) = n * k + n^{log_27} => T(n) = Θ(n^{log_27}) </script></p>
<p>A continuaci&#xF3;n, lo que vamos a hacer es ejecutar el algoritmo de Strassen y el algoritmo tradicional m&#xFA;ltiples veces, comparando los resultados con los esperados seg&#xFA;n la complejidad que hemos concluido que tiene cada uno. Efectivamente, hemos implementado ambos algoritmos utilizando el lenguaje de programaci&#xF3;n Java, as&#xED; como dos programas que los ponen a prueba y nos indican el n&#xFA;mero de pasos que se han tenido que llevar a cabo. Se puede consultar el c&#xF3;digo <a href="https://github.com/alu0100881677/Strassen/tree/master/Code" target="_blank">aqu&#xED;</a>.</p>
<hr>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="./" class="navigation navigation-prev " aria-label="Previous page: Introducción">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="Comparativa.html" class="navigation navigation-next " aria-label="Next page: Comparativa gráfica">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Explicación del algoritmo","level":"1.2","depth":1,"next":{"title":"Comparativa gráfica","level":"1.3","depth":1,"path":"Comparativa.md","ref":"Comparativa.md","articles":[]},"previous":{"title":"Introducción","level":"1.1","depth":1,"path":"README.md","ref":"README.md","articles":[]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":["mathjax"],"pluginsConfig":{"mathjax":{"forceSVG":false,"version":"2.6-latest"},"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"Strassen.md","mtime":"2017-03-20T10:24:39.000Z","type":"markdown"},"gitbook":{"version":"3.2.2","time":"2017-03-20T10:26:05.909Z"},"basePath":".","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="gitbook/gitbook.js"></script>
    <script src="gitbook/theme.js"></script>
    
        
        <script src="https://cdn.mathjax.org/mathjax/2.6-latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-mathjax/plugin.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

